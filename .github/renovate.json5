{
  /**
   * Renovate Configuration
   *
   * This configuration file defines how Renovate handles dependency updates for repositories.
   * Renovate is a bot that automatically creates pull requests to update dependencies.
   *
   * Documentation: https://docs.renovatebot.com/configuration-options/
   */
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  // # keep-sorted start block=yes
  "git-submodules": {
    enabled: true,
  },
  automerge: true,
  automergeType: "branch",
  branchPrefix: "chore/renovate/",
  // This allows Renovate to detect and update dependencies that aren't in standard package files
  customManagers: [
    {
      customType: "regex",
      // Template for extracting version numbers from custom patterns
      extractVersionTemplate: "{{#if extractVersion}}{{{extractVersion}}}{{else}}^v?(?<version>.+)${{/if}}",

      // File types to scan for custom dependency patterns
      fileMatch: ["\\.ya?ml$", "\\.md$", "^Dockerfile$", "\\.sh$"],

      // Regex patterns to match custom dependency declarations
      matchStrings: [
        // Format: # renovate: datasource=<source> depName=<name> [versioning=<type>] [extractVersion=<regex>] [registryUrl=<url>]
        // Example: # renovate: datasource=github-releases depName=helm/helm versioning=semver
        //          HELM_VERSION="3.14.0"
        '# renovate: datasource=(?<datasource>.+?) depName=(?<depName>.+?)( versioning=(?<versioning>.+?))?( extractVersion=(?<extractVersion>.+?))?( registryUrl=(?<registryUrl>.+?))?\\s.*[=:]\\s*"?(?<currentValue>.+?)"?\\s',
        // Format for pinned GitHub Actions with digest in shell scripts
        // Example: # renovate: datasource=github-tags depName=oxsecurity/megalinter
        //          ["key"]="uses: oxsecurity/megalinter/flavors/ci_light@abc123...def456 # 9.2.0"
        '# renovate: datasource=(?<datasource>.+?) depName=(?<depName>.+?)\\n.*@(?<currentDigest>[a-f0-9]{40}) # (?<currentValue>[^"]+)"',
      ],

      // Default to semantic versioning unless specified otherwise
      versioningTemplate: "{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}",
    },
  ],
  // Base Configuration Presets
  // Keep the extends started with ":" at the end of the list to allow overriding
  extends: [
    "config:recommended", // Renovate's recommended configuration preset
    "docker:pinDigests", // Pin Docker image digests for security
    "helpers:pinGitHubActionDigestsToSemver", // Pin GitHub Actions to specific versions with semantic versioning
    "security:openssf-scorecard", // Add OpenSSF Scorecard security insights
    ":disableDependencyDashboard", // Don't create dependency dashboard issues
    ":disableRateLimiting", // Disable rate limiting for faster updates
    ":enableVulnerabilityAlertsWithLabel(security)", // Add security label to vulnerability alerts
    ":pinSkipCi", // Pin dependencies and skip CI for pin-only updates
  ],
  // Pull Request Labeling
  labels: [
    "renovate",
    "renovate/{{replace '.*/' '' depName}}",
    "renovate/{{updateType}}",
  ],
  // Lock File Maintenance
  lockFileMaintenance: {
    enabled: true,
    schedule: ["before 6am on Sunday"],
  },
  // Wait for releases to be at least 3 days old before creating PRs (reduces risk of buggy releases)
  minimumReleaseAge: "3 days",
  // Package-specific Update Rules
  packageRules: [
    {
      description: "Disable auto-merge for major updates",
      matchUpdateTypes: ["major"],
      automerge: false,
    },
    {
      description: "Ignore frequent renovate updates",
      enabled: false,
      matchPackageNames: ["renovatebot/github-action"],
      matchUpdateTypes: ["patch"],
    },
    {
      description: "Update renovatebot/github-action minor updates on Sundays",
      matchPackageNames: ["renovatebot/github-action"],
      matchUpdateTypes: ["minor"],
      schedule: ["* * * * 0"],
    },
  ],
  prBodyTemplate: "{{{table}}}{{{notes}}}{{{changelogs}}}",
  rebaseWhen: "behind-base-branch",
  separateMinorPatch: true,
  // # keep-sorted end
}
